import{startsWith as w,Logger as D}from"@vuepress/helper";import{fs as u,colors as m}from"vuepress/utils";import{createRequire as P}from"node:module";const r=(e,t=2)=>e.toString().padStart(t,"0"),S=e=>r(e.getFullYear(),4),h=e=>r(e.getMonth()+1),y=e=>r(e.getDate()),v=e=>r(e.getHours()),F=e=>r(e.getMinutes()),b=e=>r(e.getSeconds()),c=e=>`${S(e)}-${h(e)}-${y(e)}`,$=e=>`${v(e)}:${F(e)}:${b(e)}`,M=e=>`${c(e)} ${$(e)}`,T=async({key:e="date",format:t="date"},{data:a,filePath:i,frontmatter:l})=>{if(l[e]||!i)return;const{createdTime:o}=a.git;if(!o)return;const s=new Date(o),p=t==="time"?$(s):t==="full"?M(s):c(s);l[e]=new Date(o);const g=await u.readFile(i,"utf-8");await u.writeFile(i,w(g,`---
`)?`---
${e}: ${p}
${g.substring(4)}`:`---
${e}: ${p}
---

${g}`,"utf-8")},d="@vuepress-plugin/append-date",f=new D(d),q=P(import.meta.url),n="@vuepress/plugin-git",A=e=>{if(e.pluginApi.plugins.every(t=>t.name!==n)){try{return q.resolve(n),f.info(`${m.magenta(n)} is not enabled.`),!1}catch{f.error(`${m.magenta(n)} is required for this plugin, please install it.`)}return!1}return!0},E=(e={})=>({name:d,onInitialized:async t=>{A(t)&&await Promise.all(t.pages.map(a=>T(e,a)))}});export{E as appendDatePlugin};
//# sourceMappingURL=index.js.map
