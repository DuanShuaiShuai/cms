{"content":"<p>GitHub Actions 的配置文件叫做 <code v-pre>workflow</code> 文件，存放在代码仓库的 <code v-pre>.github/workflows</code> 目录。</p>\n<p><code v-pre>workflow</code> 文件采用 <code v-pre>YAML</code> 格式，文件名可以任意取，但是后缀名统一为 <code v-pre>.yml</code>，比如<code v-pre>foo.yml</code>。</p>\n<p>一个库可以有多个 <code v-pre>workflow</code> 文件。GitHub 只要发现 <code v-pre>.github/workflows</code> 目录里面有 <code v-pre>.yml</code> 文件，就会自动运行该文件。</p>\n<!-- more -->\n<h2 id=\"常见字段\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#常见字段\"><span>常见字段</span></a></h2>\n<p><code v-pre>workflow</code> 文件的配置字段非常多。下面是一些基本字段。</p>\n<h3 id=\"name\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#name\"><span>name</span></a></h3>\n<p><code v-pre>name</code> 字段是 <code v-pre>workflow</code> 的名称。如果省略该字段，默认为当前 <code v-pre>workflow</code> 的文件名。</p>\n<div class=\"language-yml\" data-highlighter=\"shiki\" data-ext=\"yml\" data-title=\"yml\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">name</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">GitHub Actions Demo</span></span></code></pre>\n</div><h3 id=\"on\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#on\"><span>on</span></a></h3>\n<p><code v-pre>on</code> 字段指定触发 <code v-pre>workflow</code> 的时机，通常是某些事件。</p>\n<div class=\"language-yml\" data-highlighter=\"shiki\" data-ext=\"yml\" data-title=\"yml\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 指定 push 事件触发 workflow。</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">on</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">push</span></span></code></pre>\n</div><p><code v-pre>on</code> 字段也可以是事件的数组。</p>\n<div class=\"language-yml\" data-highlighter=\"shiki\" data-ext=\"yml\" data-title=\"yml\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 指定 push 事件或 pull_request 事件都可以触发 workflow。</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">on</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: [</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">push</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">pull_request</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">]</span></span></code></pre>\n</div><p>完整的事件列表，请查看官方文档。\n除了代码库事件，GitHub Actions 也支持外部事件触发，或者定时运行。</p>\n<h4 id=\"on-push-pull-request-tags-branches\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#on-push-pull-request-tags-branches\"><span>on.&lt;push|pull_request&gt;.&lt;tags|branches&gt;</span></a></h4>\n<p>指定触发事件时，可以限定分支或标签。</p>\n<div class=\"language-yml\" data-highlighter=\"shiki\" data-ext=\"yml\" data-title=\"yml\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 指定只有 main 分支发生 push 事件时，才会触发 workflow。</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">on</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">  push</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">    branches</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">      - </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">main</span></span></code></pre>\n</div><h3 id=\"jobs\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#jobs\"><span>jobs</span></a></h3>\n<p><code v-pre>workflow</code> 文件的主体是 <code v-pre>jobs</code> 字段，表示要执行的一项或多项任务。</p>\n<p><code v-pre>jobs</code> 字段里面，需要写出每一项任务的 <code v-pre>job_id</code>，具体名称自定义。</p>\n<h4 id=\"jobs-job-id-name\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#jobs-job-id-name\"><span>jobs.&lt;job_id&gt;.name</span></a></h4>\n<p><code v-pre>job_id</code> 里面的 <code v-pre>name</code> 字段是任务的说明(可填可不填)。</p>\n<div class=\"language-yml\" data-highlighter=\"shiki\" data-ext=\"yml\" data-title=\"yml\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">jobs</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">  my_first_job</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">    name</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">My first job</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">  my_second_job</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">    name</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">My second job</span></span></code></pre>\n</div><p>上面代码的 <code v-pre>jobs</code> 字段包含两项任务，<code v-pre>job_id</code> 分别是 <code v-pre>my_first_job</code> 和 <code v-pre>my_second_job</code>。</p>\n<h4 id=\"jobs-job-id-needs\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#jobs-job-id-needs\"><span>jobs.&lt;job_id&gt;.needs</span></a></h4>\n<p><code v-pre>needs</code> 字段指定当前任务的依赖关系，即运行顺序。</p>\n<div class=\"language-yml\" data-highlighter=\"shiki\" data-ext=\"yml\" data-title=\"yml\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 这个 workflow 的运行顺序依次为: job1、job2、job3。</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">jobs</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">  job1</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">  job2</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">    needs</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">job1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">  job3</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">    needs</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: [</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">job1</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">job2</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">]</span></span></code></pre>\n</div><h4 id=\"jobs-job-id-runs-on\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#jobs-job-id-runs-on\"><span>jobs.&lt;job_id&gt;.runs-on</span></a></h4>\n<p><code v-pre>runs-on</code> 字段指定运行所需要的虚拟机环境。\n它是<strong>必填字段</strong>。目前可用的虚拟机如下。</p>\n<p><code v-pre>ubuntu-latest</code>，<code v-pre>ubuntu-18.04</code> 或 <code v-pre>ubuntu-16.04</code></p>\n<p><code v-pre>windows-latest</code>，<code v-pre>windows-2019</code> 或 <code v-pre>windows-2016</code></p>\n<p><code v-pre>macOS-latest</code> 或 <code v-pre>macOS-10.14</code></p>\n<div class=\"language-yml\" data-highlighter=\"shiki\" data-ext=\"yml\" data-title=\"yml\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 代码指定虚拟机环境为 ubuntu-18.04。</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">runs-on</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">ubuntu-18.04</span></span></code></pre>\n</div><h4 id=\"jobs-job-id-steps\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#jobs-job-id-steps\"><span>jobs.&lt;job_id&gt;.steps</span></a></h4>\n<p><code v-pre>steps</code> 字段指定每个 <code v-pre>Job</code> 的运行步骤，可以包含一个或多个步骤。每个步骤都可以指定以下三个字段。</p>\n<ul>\n<li><code v-pre>jobs.&lt;job_id&gt;.steps.name</code>: 步骤名称。</li>\n<li><code v-pre>jobs.&lt;job_id&gt;.steps.run</code>: 该步骤运行的命令或者 action。</li>\n<li><code v-pre>jobs.&lt;job_id&gt;.steps.env</code>: 该步骤所需的环境变量。</li>\n</ul>\n<p>下面是一个完整的 <code v-pre>workflow</code> 文件的范例。</p>\n<div class=\"language-yml line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"yml\" data-title=\"yml\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">name</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">Greeting from Mona</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">on</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">push</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">jobs</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">  my-job</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">    name</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">My Job</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">    runs-on</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">ubuntu-latest</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">    steps</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># steps 字段只包括一个步骤。该步骤先注入四个环境变量，然后执行一条 Bash 命令。</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">      - </span><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">name</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">Print a greeting</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">        env</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">          MY_VAR</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">Hi there! My name is</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">          FIRST_NAME</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">Mona</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">          MIDDLE_NAME</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">The</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">          LAST_NAME</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">Octocat</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">        run</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">|</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">          echo $MY_VAR $FIRST_NAME $MIDDLE_NAME $LAST_NAME.</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"官方文档\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#官方文档\"><span>官方文档</span></a></h2>\n<p>关于完整的工作流程语法，详见 <a href=\"https://docs.github.com/cn/actions/reference/workflow-syntax-for-github-actions\" target=\"_blank\" rel=\"noopener noreferrer\">GitHub 操作的工作流程语法</a></p>\n","env":{"base":"/","filePath":"/Users/carson/Desktop/Mister-Hope.github.io-main/src/code/github/actions/config.md","filePathRelative":"code/github/actions/config.md","frontmatter":{"title":"Action 配置","icon":"config","date":"2021-02-18T00:00:00.000Z","category":"GitHub","tag":["action","workflow"],"order":2},"sfcBlocks":{"template":{"type":"template","content":"<template><p>GitHub Actions 的配置文件叫做 <code v-pre>workflow</code> 文件，存放在代码仓库的 <code v-pre>.github/workflows</code> 目录。</p>\n<p><code v-pre>workflow</code> 文件采用 <code v-pre>YAML</code> 格式，文件名可以任意取，但是后缀名统一为 <code v-pre>.yml</code>，比如<code v-pre>foo.yml</code>。</p>\n<p>一个库可以有多个 <code v-pre>workflow</code> 文件。GitHub 只要发现 <code v-pre>.github/workflows</code> 目录里面有 <code v-pre>.yml</code> 文件，就会自动运行该文件。</p>\n<!-- more -->\n<h2 id=\"常见字段\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#常见字段\"><span>常见字段</span></a></h2>\n<p><code v-pre>workflow</code> 文件的配置字段非常多。下面是一些基本字段。</p>\n<h3 id=\"name\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#name\"><span>name</span></a></h3>\n<p><code v-pre>name</code> 字段是 <code v-pre>workflow</code> 的名称。如果省略该字段，默认为当前 <code v-pre>workflow</code> 的文件名。</p>\n<div class=\"language-yml\" data-highlighter=\"shiki\" data-ext=\"yml\" data-title=\"yml\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">name</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">GitHub Actions Demo</span></span></code></pre>\n</div><h3 id=\"on\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#on\"><span>on</span></a></h3>\n<p><code v-pre>on</code> 字段指定触发 <code v-pre>workflow</code> 的时机，通常是某些事件。</p>\n<div class=\"language-yml\" data-highlighter=\"shiki\" data-ext=\"yml\" data-title=\"yml\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 指定 push 事件触发 workflow。</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">on</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">push</span></span></code></pre>\n</div><p><code v-pre>on</code> 字段也可以是事件的数组。</p>\n<div class=\"language-yml\" data-highlighter=\"shiki\" data-ext=\"yml\" data-title=\"yml\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 指定 push 事件或 pull_request 事件都可以触发 workflow。</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">on</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: [</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">push</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">pull_request</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">]</span></span></code></pre>\n</div><p>完整的事件列表，请查看官方文档。\n除了代码库事件，GitHub Actions 也支持外部事件触发，或者定时运行。</p>\n<h4 id=\"on-push-pull-request-tags-branches\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#on-push-pull-request-tags-branches\"><span>on.&lt;push|pull_request&gt;.&lt;tags|branches&gt;</span></a></h4>\n<p>指定触发事件时，可以限定分支或标签。</p>\n<div class=\"language-yml\" data-highlighter=\"shiki\" data-ext=\"yml\" data-title=\"yml\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 指定只有 main 分支发生 push 事件时，才会触发 workflow。</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">on</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">  push</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">    branches</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">      - </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">main</span></span></code></pre>\n</div><h3 id=\"jobs\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#jobs\"><span>jobs</span></a></h3>\n<p><code v-pre>workflow</code> 文件的主体是 <code v-pre>jobs</code> 字段，表示要执行的一项或多项任务。</p>\n<p><code v-pre>jobs</code> 字段里面，需要写出每一项任务的 <code v-pre>job_id</code>，具体名称自定义。</p>\n<h4 id=\"jobs-job-id-name\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#jobs-job-id-name\"><span>jobs.&lt;job_id&gt;.name</span></a></h4>\n<p><code v-pre>job_id</code> 里面的 <code v-pre>name</code> 字段是任务的说明(可填可不填)。</p>\n<div class=\"language-yml\" data-highlighter=\"shiki\" data-ext=\"yml\" data-title=\"yml\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">jobs</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">  my_first_job</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">    name</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">My first job</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">  my_second_job</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">    name</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">My second job</span></span></code></pre>\n</div><p>上面代码的 <code v-pre>jobs</code> 字段包含两项任务，<code v-pre>job_id</code> 分别是 <code v-pre>my_first_job</code> 和 <code v-pre>my_second_job</code>。</p>\n<h4 id=\"jobs-job-id-needs\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#jobs-job-id-needs\"><span>jobs.&lt;job_id&gt;.needs</span></a></h4>\n<p><code v-pre>needs</code> 字段指定当前任务的依赖关系，即运行顺序。</p>\n<div class=\"language-yml\" data-highlighter=\"shiki\" data-ext=\"yml\" data-title=\"yml\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 这个 workflow 的运行顺序依次为: job1、job2、job3。</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">jobs</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">  job1</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">  job2</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">    needs</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">job1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">  job3</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">    needs</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: [</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">job1</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">job2</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">]</span></span></code></pre>\n</div><h4 id=\"jobs-job-id-runs-on\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#jobs-job-id-runs-on\"><span>jobs.&lt;job_id&gt;.runs-on</span></a></h4>\n<p><code v-pre>runs-on</code> 字段指定运行所需要的虚拟机环境。\n它是<strong>必填字段</strong>。目前可用的虚拟机如下。</p>\n<p><code v-pre>ubuntu-latest</code>，<code v-pre>ubuntu-18.04</code> 或 <code v-pre>ubuntu-16.04</code></p>\n<p><code v-pre>windows-latest</code>，<code v-pre>windows-2019</code> 或 <code v-pre>windows-2016</code></p>\n<p><code v-pre>macOS-latest</code> 或 <code v-pre>macOS-10.14</code></p>\n<div class=\"language-yml\" data-highlighter=\"shiki\" data-ext=\"yml\" data-title=\"yml\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 代码指定虚拟机环境为 ubuntu-18.04。</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">runs-on</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">ubuntu-18.04</span></span></code></pre>\n</div><h4 id=\"jobs-job-id-steps\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#jobs-job-id-steps\"><span>jobs.&lt;job_id&gt;.steps</span></a></h4>\n<p><code v-pre>steps</code> 字段指定每个 <code v-pre>Job</code> 的运行步骤，可以包含一个或多个步骤。每个步骤都可以指定以下三个字段。</p>\n<ul>\n<li><code v-pre>jobs.&lt;job_id&gt;.steps.name</code>: 步骤名称。</li>\n<li><code v-pre>jobs.&lt;job_id&gt;.steps.run</code>: 该步骤运行的命令或者 action。</li>\n<li><code v-pre>jobs.&lt;job_id&gt;.steps.env</code>: 该步骤所需的环境变量。</li>\n</ul>\n<p>下面是一个完整的 <code v-pre>workflow</code> 文件的范例。</p>\n<div class=\"language-yml line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"yml\" data-title=\"yml\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">name</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">Greeting from Mona</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">on</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">push</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">jobs</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">  my-job</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">    name</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">My Job</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">    runs-on</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">ubuntu-latest</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">    steps</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># steps 字段只包括一个步骤。该步骤先注入四个环境变量，然后执行一条 Bash 命令。</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">      - </span><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">name</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">Print a greeting</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">        env</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">          MY_VAR</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">Hi there! My name is</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">          FIRST_NAME</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">Mona</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">          MIDDLE_NAME</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">The</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">          LAST_NAME</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">Octocat</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">        run</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">|</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">          echo $MY_VAR $FIRST_NAME $MIDDLE_NAME $LAST_NAME.</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"官方文档\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#官方文档\"><span>官方文档</span></a></h2>\n<p>关于完整的工作流程语法，详见 <a href=\"https://docs.github.com/cn/actions/reference/workflow-syntax-for-github-actions\" target=\"_blank\" rel=\"noopener noreferrer\">GitHub 操作的工作流程语法</a></p>\n</template>","contentStripped":"<p>GitHub Actions 的配置文件叫做 <code v-pre>workflow</code> 文件，存放在代码仓库的 <code v-pre>.github/workflows</code> 目录。</p>\n<p><code v-pre>workflow</code> 文件采用 <code v-pre>YAML</code> 格式，文件名可以任意取，但是后缀名统一为 <code v-pre>.yml</code>，比如<code v-pre>foo.yml</code>。</p>\n<p>一个库可以有多个 <code v-pre>workflow</code> 文件。GitHub 只要发现 <code v-pre>.github/workflows</code> 目录里面有 <code v-pre>.yml</code> 文件，就会自动运行该文件。</p>\n<!-- more -->\n<h2 id=\"常见字段\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#常见字段\"><span>常见字段</span></a></h2>\n<p><code v-pre>workflow</code> 文件的配置字段非常多。下面是一些基本字段。</p>\n<h3 id=\"name\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#name\"><span>name</span></a></h3>\n<p><code v-pre>name</code> 字段是 <code v-pre>workflow</code> 的名称。如果省略该字段，默认为当前 <code v-pre>workflow</code> 的文件名。</p>\n<div class=\"language-yml\" data-highlighter=\"shiki\" data-ext=\"yml\" data-title=\"yml\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">name</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">GitHub Actions Demo</span></span></code></pre>\n</div><h3 id=\"on\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#on\"><span>on</span></a></h3>\n<p><code v-pre>on</code> 字段指定触发 <code v-pre>workflow</code> 的时机，通常是某些事件。</p>\n<div class=\"language-yml\" data-highlighter=\"shiki\" data-ext=\"yml\" data-title=\"yml\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 指定 push 事件触发 workflow。</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">on</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">push</span></span></code></pre>\n</div><p><code v-pre>on</code> 字段也可以是事件的数组。</p>\n<div class=\"language-yml\" data-highlighter=\"shiki\" data-ext=\"yml\" data-title=\"yml\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 指定 push 事件或 pull_request 事件都可以触发 workflow。</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">on</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: [</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">push</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">pull_request</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">]</span></span></code></pre>\n</div><p>完整的事件列表，请查看官方文档。\n除了代码库事件，GitHub Actions 也支持外部事件触发，或者定时运行。</p>\n<h4 id=\"on-push-pull-request-tags-branches\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#on-push-pull-request-tags-branches\"><span>on.&lt;push|pull_request&gt;.&lt;tags|branches&gt;</span></a></h4>\n<p>指定触发事件时，可以限定分支或标签。</p>\n<div class=\"language-yml\" data-highlighter=\"shiki\" data-ext=\"yml\" data-title=\"yml\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 指定只有 main 分支发生 push 事件时，才会触发 workflow。</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">on</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">  push</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">    branches</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">      - </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">main</span></span></code></pre>\n</div><h3 id=\"jobs\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#jobs\"><span>jobs</span></a></h3>\n<p><code v-pre>workflow</code> 文件的主体是 <code v-pre>jobs</code> 字段，表示要执行的一项或多项任务。</p>\n<p><code v-pre>jobs</code> 字段里面，需要写出每一项任务的 <code v-pre>job_id</code>，具体名称自定义。</p>\n<h4 id=\"jobs-job-id-name\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#jobs-job-id-name\"><span>jobs.&lt;job_id&gt;.name</span></a></h4>\n<p><code v-pre>job_id</code> 里面的 <code v-pre>name</code> 字段是任务的说明(可填可不填)。</p>\n<div class=\"language-yml\" data-highlighter=\"shiki\" data-ext=\"yml\" data-title=\"yml\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">jobs</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">  my_first_job</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">    name</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">My first job</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">  my_second_job</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">    name</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">My second job</span></span></code></pre>\n</div><p>上面代码的 <code v-pre>jobs</code> 字段包含两项任务，<code v-pre>job_id</code> 分别是 <code v-pre>my_first_job</code> 和 <code v-pre>my_second_job</code>。</p>\n<h4 id=\"jobs-job-id-needs\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#jobs-job-id-needs\"><span>jobs.&lt;job_id&gt;.needs</span></a></h4>\n<p><code v-pre>needs</code> 字段指定当前任务的依赖关系，即运行顺序。</p>\n<div class=\"language-yml\" data-highlighter=\"shiki\" data-ext=\"yml\" data-title=\"yml\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 这个 workflow 的运行顺序依次为: job1、job2、job3。</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">jobs</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">  job1</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">  job2</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">    needs</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">job1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">  job3</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">    needs</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: [</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">job1</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">job2</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">]</span></span></code></pre>\n</div><h4 id=\"jobs-job-id-runs-on\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#jobs-job-id-runs-on\"><span>jobs.&lt;job_id&gt;.runs-on</span></a></h4>\n<p><code v-pre>runs-on</code> 字段指定运行所需要的虚拟机环境。\n它是<strong>必填字段</strong>。目前可用的虚拟机如下。</p>\n<p><code v-pre>ubuntu-latest</code>，<code v-pre>ubuntu-18.04</code> 或 <code v-pre>ubuntu-16.04</code></p>\n<p><code v-pre>windows-latest</code>，<code v-pre>windows-2019</code> 或 <code v-pre>windows-2016</code></p>\n<p><code v-pre>macOS-latest</code> 或 <code v-pre>macOS-10.14</code></p>\n<div class=\"language-yml\" data-highlighter=\"shiki\" data-ext=\"yml\" data-title=\"yml\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># 代码指定虚拟机环境为 ubuntu-18.04。</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">runs-on</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">ubuntu-18.04</span></span></code></pre>\n</div><h4 id=\"jobs-job-id-steps\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#jobs-job-id-steps\"><span>jobs.&lt;job_id&gt;.steps</span></a></h4>\n<p><code v-pre>steps</code> 字段指定每个 <code v-pre>Job</code> 的运行步骤，可以包含一个或多个步骤。每个步骤都可以指定以下三个字段。</p>\n<ul>\n<li><code v-pre>jobs.&lt;job_id&gt;.steps.name</code>: 步骤名称。</li>\n<li><code v-pre>jobs.&lt;job_id&gt;.steps.run</code>: 该步骤运行的命令或者 action。</li>\n<li><code v-pre>jobs.&lt;job_id&gt;.steps.env</code>: 该步骤所需的环境变量。</li>\n</ul>\n<p>下面是一个完整的 <code v-pre>workflow</code> 文件的范例。</p>\n<div class=\"language-yml line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"yml\" data-title=\"yml\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">name</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">Greeting from Mona</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">on</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">push</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">jobs</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">  my-job</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">    name</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">My Job</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">    runs-on</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">ubuntu-latest</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">    steps</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># steps 字段只包括一个步骤。该步骤先注入四个环境变量，然后执行一条 Bash 命令。</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">      - </span><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">name</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">Print a greeting</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">        env</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">          MY_VAR</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">Hi there! My name is</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">          FIRST_NAME</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">Mona</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">          MIDDLE_NAME</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">The</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">          LAST_NAME</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">Octocat</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\">        run</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">: </span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">|</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">          echo $MY_VAR $FIRST_NAME $MIDDLE_NAME $LAST_NAME.</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"官方文档\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#官方文档\"><span>官方文档</span></a></h2>\n<p>关于完整的工作流程语法，详见 <a href=\"https://docs.github.com/cn/actions/reference/workflow-syntax-for-github-actions\" target=\"_blank\" rel=\"noopener noreferrer\">GitHub 操作的工作流程语法</a></p>\n","tagOpen":"<template>","tagClose":"</template>"},"script":null,"scriptSetup":null,"scripts":[],"styles":[],"customBlocks":[]},"content":"\nGitHub Actions 的配置文件叫做 `workflow` 文件，存放在代码仓库的 `.github/workflows` 目录。\n\n`workflow` 文件采用 `YAML` 格式，文件名可以任意取，但是后缀名统一为 `.yml`，比如`foo.yml`。\n\n一个库可以有多个 `workflow` 文件。GitHub 只要发现 `.github/workflows` 目录里面有 `.yml` 文件，就会自动运行该文件。\n\n<!-- more -->\n\n## 常见字段\n\n`workflow` 文件的配置字段非常多。下面是一些基本字段。\n\n### name\n\n`name` 字段是 `workflow` 的名称。如果省略该字段，默认为当前 `workflow` 的文件名。\n\n```yml\nname: GitHub Actions Demo\n```\n\n### on\n\n`on` 字段指定触发 `workflow` 的时机，通常是某些事件。\n\n```yml\n# 指定 push 事件触发 workflow。\non: push\n```\n\n`on` 字段也可以是事件的数组。\n\n```yml\n# 指定 push 事件或 pull_request 事件都可以触发 workflow。\non: [push, pull_request]\n```\n\n完整的事件列表，请查看官方文档。\n除了代码库事件，GitHub Actions 也支持外部事件触发，或者定时运行。\n\n#### on.<push|pull_request>.<tags|branches>\n\n指定触发事件时，可以限定分支或标签。\n\n```yml\n# 指定只有 main 分支发生 push 事件时，才会触发 workflow。\non:\n  push:\n    branches:\n      - main\n```\n\n### jobs\n\n`workflow` 文件的主体是 `jobs` 字段，表示要执行的一项或多项任务。\n\n`jobs` 字段里面，需要写出每一项任务的 `job_id`，具体名称自定义。\n\n#### jobs.<job_id>.name\n\n`job_id` 里面的 `name` 字段是任务的说明(可填可不填)。\n\n```yml\njobs:\n  my_first_job:\n    name: My first job\n  my_second_job:\n    name: My second job\n```\n\n上面代码的 `jobs` 字段包含两项任务，`job_id` 分别是 `my_first_job` 和 `my_second_job`。\n\n#### jobs.<job_id>.needs\n\n`needs` 字段指定当前任务的依赖关系，即运行顺序。\n\n```yml\n# 这个 workflow 的运行顺序依次为: job1、job2、job3。\njobs:\n  job1:\n  job2:\n    needs: job1\n  job3:\n    needs: [job1, job2]\n```\n\n#### jobs.<job_id>.runs-on\n\n`runs-on` 字段指定运行所需要的虚拟机环境。\n它是**必填字段**。目前可用的虚拟机如下。\n\n`ubuntu-latest`，`ubuntu-18.04` 或 `ubuntu-16.04`\n\n`windows-latest`，`windows-2019` 或 `windows-2016`\n\n`macOS-latest` 或 `macOS-10.14`\n\n```yml\n# 代码指定虚拟机环境为 ubuntu-18.04。\nruns-on: ubuntu-18.04\n```\n\n#### jobs.<job_id>.steps\n\n`steps` 字段指定每个 `Job` 的运行步骤，可以包含一个或多个步骤。每个步骤都可以指定以下三个字段。\n\n- `jobs.<job_id>.steps.name`: 步骤名称。\n- `jobs.<job_id>.steps.run`: 该步骤运行的命令或者 action。\n- `jobs.<job_id>.steps.env`: 该步骤所需的环境变量。\n\n下面是一个完整的 `workflow` 文件的范例。\n\n```yml\nname: Greeting from Mona\non: push\n\njobs:\n  my-job:\n    name: My Job\n    runs-on: ubuntu-latest\n    steps: # steps 字段只包括一个步骤。该步骤先注入四个环境变量，然后执行一条 Bash 命令。\n      - name: Print a greeting\n        env:\n          MY_VAR: Hi there! My name is\n          FIRST_NAME: Mona\n          MIDDLE_NAME: The\n          LAST_NAME: Octocat\n        run: |\n          echo $MY_VAR $FIRST_NAME $MIDDLE_NAME $LAST_NAME.\n```\n\n## 官方文档\n\n关于完整的工作流程语法，详见 [GitHub 操作的工作流程语法](https://docs.github.com/cn/actions/reference/workflow-syntax-for-github-actions)\n","excerpt":"","title":"","headers":[{"level":2,"title":"常见字段","slug":"常见字段","link":"#常见字段","children":[{"level":3,"title":"name","slug":"name","link":"#name","children":[]},{"level":3,"title":"on","slug":"on","link":"#on","children":[]},{"level":3,"title":"jobs","slug":"jobs","link":"#jobs","children":[]}]},{"level":2,"title":"官方文档","slug":"官方文档","link":"#官方文档","children":[]}]}}
