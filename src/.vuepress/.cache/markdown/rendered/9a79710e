{"content":"<p>在最新的 Python 3 版本中，字符串是以 Unicode 编码的，也就是说，Python 的字符串支持多语言，例如:</p>\n<div class=\"language-sh\" data-highlighter=\"shiki\" data-ext=\"sh\" data-title=\"sh\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">>>> </span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\">print</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">'包含中文的str'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">包含中文的str</span></span></code></pre>\n</div><p>对于单个字符的编码，Python 提供了 <code v-pre>ord()</code> 函数获取字符的整数表示，<code v-pre>chr()</code> 函数把编码转换为对应的字符:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\"> ord</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'A'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">65</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\"> ord</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'中'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">20013</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\"> chr</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">66</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'B'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\"> chr</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">25991</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'文'</span></span></code></pre>\n</div><p>如果知道字符的整数编码，还可以用十六进制这么写 <code v-pre>str</code>:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> '</span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\">\\u4e2d\\u6587</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'中文'</span></span></code></pre>\n</div><p>两种写法完全是等价的。</p>\n<p>由于 Python 的字符串类型是 <code v-pre>str</code>，在内存中以 Unicode 表示，一个字符对应若干个字节。如果要在网络上传输，或者保存到磁盘上，就需要把 <code v-pre>str</code> 变为以字节为单位的 <code v-pre>bytes</code>。</p>\n<p>Python 对 <code v-pre>bytes</code> 类型的数据用带 <code v-pre>b</code> 前缀的单引号或双引号表示:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">x </span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> b</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'ABC'</span></span></code></pre>\n</div><p>要注意区分 <code v-pre>'ABC'</code> 和 <code v-pre>b'ABC'</code>，前者是 <code v-pre>str</code>，后者虽然内容显示得和前者一样，但 <code v-pre>bytes</code> 的每个字符都只占用一个字节。</p>\n<p>以 Unicode 表示的 <code v-pre>str</code> 通过 <code v-pre>encode()</code> 方法可以编码为指定的 <code v-pre>bytes</code>，例如:</p>\n<div class=\"language-sh\" data-highlighter=\"shiki\" data-ext=\"sh\" data-title=\"sh\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">>>> </span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">'ABC'</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">.encode(</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">'ascii'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">b</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">'ABC'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">>>> </span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">'中文'</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">.encode(</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">'utf-8'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">b</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">'\\xe4\\xb8\\xad\\xe6\\x96\\x87'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">>>> </span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">'中文'</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">.encode(</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">'ascii'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">Traceback</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> (most </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">recent</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> call</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> last</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">):</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">  File</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> \"&#x3C;stdin>\",</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> line</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> 1,</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> in</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> &#x3C;</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">modul</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">e></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">UnicodeEncodeError:</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> 'ascii'</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> codec</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> can't encode characters in position 0-1: ordinal not in range(128)</span></span></code></pre>\n</div><p>纯英文的 <code v-pre>str</code> 可以用 ASCII 编码为 <code v-pre>bytes</code>，内容是一样的，含有中文的 <code v-pre>str</code> 可以用 UTF-8 编码为 <code v-pre>bytes</code>。含有中文的 <code v-pre>str</code> 无法用 ASCII 编码，因为中文编码的范围超过了 ASCII 编码的范围，Python 会报错。</p>\n<p>在 <code v-pre>bytes</code> 中，无法显示为 ASCII 字符的字节，用 <code v-pre>\\x##</code> 显示。</p>\n<p>反过来，如果我们从网络或磁盘上读取了字节流，那么读到的数据就是 <code v-pre>bytes</code>。要把 <code v-pre>bytes</code> 变为 <code v-pre>str</code>，就需要用 <code v-pre>decode()</code> 方法:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> b</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'ABC'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#383A42;--shiki-dark:#61AFEF\">decode</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'ascii'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'ABC'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> b</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\">\\xe4\\xb8\\xad\\xe6\\x96\\x87</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#383A42;--shiki-dark:#61AFEF\">decode</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'utf-8'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'中文'</span></span></code></pre>\n</div><p>如果 <code v-pre>bytes</code> 中包含无法解码的字节，<code v-pre>decode()</code> 方法会报错:</p>\n<div class=\"language-sh\" data-highlighter=\"shiki\" data-ext=\"sh\" data-title=\"sh\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">>>> </span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">b</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">'\\xe4\\xb8\\xad\\xff'</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">.decode(</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">'utf-8'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">Traceback</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> (most </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">recent</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> call</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> last</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">):</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\">  ...</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">UnicodeDecodeError:</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> 'utf-8'</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> codec</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> can't decode byte 0xff in position 3: invalid start byte</span></span></code></pre>\n</div><p>如果 <code v-pre>bytes</code> 中只有一小部分无效的字节，可以传入 <code v-pre>errors='ignore'</code> 忽略错误的字节:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> b</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\">\\xe4\\xb8\\xad\\xff</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#383A42;--shiki-dark:#61AFEF\">decode</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'utf-8'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">errors</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'ignore'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'中'</span></span></code></pre>\n</div><p>要计算 <code v-pre>str</code> 包含多少个字符，可以用 <code v-pre>len()</code> 函数:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\"> len</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'ABC'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">3</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\"> len</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'中文'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">2</span></span></code></pre>\n</div><p><code v-pre>len()</code> 函数计算的是 <code v-pre>str</code> 的字符数，如果换成 <code v-pre>bytes</code>，<code v-pre>len()</code> 函数就计算字节数:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\"> len</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">b</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'ABC'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">3</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\"> len</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">b</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\">\\xe4\\xb8\\xad\\xe6\\x96\\x87</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">6</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\"> len</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'中文'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#383A42;--shiki-dark:#61AFEF\">encode</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'utf-8'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">))</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">6</span></span></code></pre>\n</div><p>可见，1 个中文字符经过 UTF-8 编码后通常会占用 3 个字节，而 1 个英文字符只占用 1 个字节。</p>\n<p>在操作字符串时，我们经常遇到 <code v-pre>str</code> 和 <code v-pre>bytes</code> 的互相转换。为了避免乱码问题，应当始终坚持使用 UTF-8 编码对 <code v-pre>str</code> 和 <code v-pre>bytes</code> 进行转换。</p>\n<p>由于 Python 源代码也是一个文本文件，所以，当您的源代码中包含中文的时候，在保存源代码时，就需要务必指定保存为 UTF-8 编码。当 Python 解释器读取源代码时，为了让它按 UTF-8 编码读取，我们通常在文件开头写上这两行:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># !/usr/bin/env python3</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># -*- coding: utf-8 -*-</span></span></code></pre>\n</div><p>第一行注释是为了告诉 Linux/macOS 系统，这是一个 Python 可执行程序，Windows 系统会忽略这个注释；</p>\n<p>第二行注释是为了告诉 Python 解释器，按照 UTF-8 编码读取源代码，否则，您在源代码中写的中文输出可能会有乱码。</p>\n<p>申明了 UTF-8 编码并不意味着您的 <code v-pre>.py</code> 文件就是 UTF-8 编码的，必须并且要确保文本编辑器正在使用 &quot;UTF-8 without BOM&quot; 编码。</p>\n<div class=\"hint-container info\">\n<p class=\"hint-container-title\">相关信息</p>\n<p>旧版 Windows 记事本的 UTF-8 是 UTF-8 with BOM。</p>\n<ul>\n<li>具体详情请见 <RouteLink to=\"/code/windows/notepad.html\">记事本的遗留问题</RouteLink></li>\n</ul>\n</div>\n<p>如果 <code v-pre>.py</code> 文件本身使用 UTF-8 编码，并且也申明了 <code v-pre># -*- coding: utf-8 -*-</code>，打开命令提示符测试就可以正常显示中文。</p>\n<h2 id=\"格式化\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#格式化\"><span>格式化</span></a></h2>\n<p>一个常见的问题是如何输出格式化的字符串。我们经常会输出类似 <code v-pre>'亲爱的xxx您好! 您xx月的话费是xx，余额是xx'</code> 之类的字符串，而 <code v-pre>xxx</code> 的内容都是根据变量变化的，所以，需要一种简便的格式化字符串的方式。</p>\n<p>在 Python 中，采用的格式化方式和 C 语言是一致的，用 <code v-pre>%</code> 实现，举例如下:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> 'Hello, </span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">%s</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\"> %</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> 'world'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'Hello, world'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> 'Hi, </span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">%s</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">, you have $</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">%d</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">.'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\"> %</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'Michael'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">1000000</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'Hi, Michael, you have $1000000.'</span></span></code></pre>\n</div><p>没错，<code v-pre>%</code> 运算符就是用来格式化字符串的。在字符串内部，<code v-pre>%s</code> 表示用字符串替换，<code v-pre>%d</code> 表示用整数替换，有几个 <code v-pre>%?</code> 占位符，后面就跟几个变量或者值，顺序要对应好。如果只有一个 <code v-pre>%?</code>，括号可以省略。</p>\n<div class=\"hint-container info\">\n<p class=\"hint-container-title\">常见的占位符有</p>\n<table>\n<thead>\n<tr>\n<th>占位符</th>\n<th>替换内容</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code v-pre>%d</code></td>\n<td>整数</td>\n</tr>\n<tr>\n<td><code v-pre>%f</code></td>\n<td>浮点数</td>\n</tr>\n<tr>\n<td><code v-pre>%s</code></td>\n<td>字符串</td>\n</tr>\n<tr>\n<td><code v-pre>%x</code></td>\n<td>十六进制整数</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>其中，格式化整数和浮点数还可以指定是否补 0 和整数与小数的位数:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># -*- coding: utf-8 -*-</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\">print</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">%2d</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">-</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">%02d</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\"> %</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">3</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">1</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">))</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\">print</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">%.2f</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\"> %</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\"> 3.1415926</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span></code></pre>\n</div><p>如果您不太确定应该用什么，<code v-pre>%s</code> 永远起作用，它会把任何数据类型转换为字符串:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> 'Age: </span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">%s</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">. Gender: </span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">%s</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\"> %</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">25</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">True</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'Age: 25. Gender: True'</span></span></code></pre>\n</div><p>有些时候，字符串里面的 <code v-pre>%</code> 是一个普通字符怎么办? 这个时候就需要转义，用 <code v-pre>%%</code> 来表示一个 <code v-pre>%</code>:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> 'growth rate: </span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">%d</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\"> %%</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\"> %</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\"> 7</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'growth rate: 7 %'</span></span></code></pre>\n</div><h3 id=\"format\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#format\"><span>format()</span></a></h3>\n<p>另一种格式化字符串的方法是使用字符串的 <code v-pre>format()</code> 方法，它会用传入的参数依次替换字符串内的占位符 <code v-pre>{0}</code>、<code v-pre>{1}</code>……，不过这种方式写起来比 <code v-pre>%</code> 要麻烦得多:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> 'Hello, </span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">{0}</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">, 成绩提升了 </span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">{1</span><span style=\"--shiki-light:#986801;--shiki-dark:#C678DD\">:.1f</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">}</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">%'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#383A42;--shiki-dark:#61AFEF\">format</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'小明'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">17.125</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'Hello, 小明, 成绩提升了 17.1%'</span></span></code></pre>\n</div><h3 id=\"小结\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#小结\"><span>小结</span></a></h3>\n<p>Python 3 的字符串使用 Unicode，直接支持多语言。</p>\n<p>当 <code v-pre>str</code> 和 <code v-pre>bytes</code> 互相转换时，需要指定编码。最常用的编码是 <code v-pre>UTF-8</code>。Python 当然也支持其他编码方式，比如把 Unicode 编码成 <code v-pre>GB2312</code>:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> '中文'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#383A42;--shiki-dark:#61AFEF\">encode</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'gb2312'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">b</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\">\\xd6\\xd0\\xce\\xc4</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span></span></code></pre>\n</div><p>但这种方式纯属自找麻烦，如果没有特殊业务要求，请牢记仅使用 UTF-8 编码。</p>\n<p>格式化字符串的时候，可以用 Python 的交互式环境测试，方便快捷。</p>\n","env":{"base":"/","filePath":"/Users/carson/Desktop/Mister-Hope.github.io-main/src/code/language/python/guide/string.md","filePathRelative":"code/language/python/guide/string.md","frontmatter":{"title":"字符串","icon":"string","author":"廖雪峰","date":"2020-05-22T00:00:00.000Z","category":"Python"},"sfcBlocks":{"template":{"type":"template","content":"<template><p>在最新的 Python 3 版本中，字符串是以 Unicode 编码的，也就是说，Python 的字符串支持多语言，例如:</p>\n<div class=\"language-sh\" data-highlighter=\"shiki\" data-ext=\"sh\" data-title=\"sh\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">>>> </span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\">print</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">'包含中文的str'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">包含中文的str</span></span></code></pre>\n</div><p>对于单个字符的编码，Python 提供了 <code v-pre>ord()</code> 函数获取字符的整数表示，<code v-pre>chr()</code> 函数把编码转换为对应的字符:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\"> ord</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'A'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">65</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\"> ord</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'中'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">20013</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\"> chr</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">66</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'B'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\"> chr</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">25991</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'文'</span></span></code></pre>\n</div><p>如果知道字符的整数编码，还可以用十六进制这么写 <code v-pre>str</code>:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> '</span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\">\\u4e2d\\u6587</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'中文'</span></span></code></pre>\n</div><p>两种写法完全是等价的。</p>\n<p>由于 Python 的字符串类型是 <code v-pre>str</code>，在内存中以 Unicode 表示，一个字符对应若干个字节。如果要在网络上传输，或者保存到磁盘上，就需要把 <code v-pre>str</code> 变为以字节为单位的 <code v-pre>bytes</code>。</p>\n<p>Python 对 <code v-pre>bytes</code> 类型的数据用带 <code v-pre>b</code> 前缀的单引号或双引号表示:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">x </span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> b</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'ABC'</span></span></code></pre>\n</div><p>要注意区分 <code v-pre>'ABC'</code> 和 <code v-pre>b'ABC'</code>，前者是 <code v-pre>str</code>，后者虽然内容显示得和前者一样，但 <code v-pre>bytes</code> 的每个字符都只占用一个字节。</p>\n<p>以 Unicode 表示的 <code v-pre>str</code> 通过 <code v-pre>encode()</code> 方法可以编码为指定的 <code v-pre>bytes</code>，例如:</p>\n<div class=\"language-sh\" data-highlighter=\"shiki\" data-ext=\"sh\" data-title=\"sh\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">>>> </span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">'ABC'</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">.encode(</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">'ascii'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">b</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">'ABC'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">>>> </span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">'中文'</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">.encode(</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">'utf-8'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">b</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">'\\xe4\\xb8\\xad\\xe6\\x96\\x87'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">>>> </span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">'中文'</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">.encode(</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">'ascii'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">Traceback</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> (most </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">recent</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> call</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> last</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">):</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">  File</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> \"&#x3C;stdin>\",</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> line</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> 1,</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> in</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> &#x3C;</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">modul</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">e></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">UnicodeEncodeError:</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> 'ascii'</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> codec</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> can't encode characters in position 0-1: ordinal not in range(128)</span></span></code></pre>\n</div><p>纯英文的 <code v-pre>str</code> 可以用 ASCII 编码为 <code v-pre>bytes</code>，内容是一样的，含有中文的 <code v-pre>str</code> 可以用 UTF-8 编码为 <code v-pre>bytes</code>。含有中文的 <code v-pre>str</code> 无法用 ASCII 编码，因为中文编码的范围超过了 ASCII 编码的范围，Python 会报错。</p>\n<p>在 <code v-pre>bytes</code> 中，无法显示为 ASCII 字符的字节，用 <code v-pre>\\x##</code> 显示。</p>\n<p>反过来，如果我们从网络或磁盘上读取了字节流，那么读到的数据就是 <code v-pre>bytes</code>。要把 <code v-pre>bytes</code> 变为 <code v-pre>str</code>，就需要用 <code v-pre>decode()</code> 方法:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> b</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'ABC'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#383A42;--shiki-dark:#61AFEF\">decode</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'ascii'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'ABC'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> b</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\">\\xe4\\xb8\\xad\\xe6\\x96\\x87</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#383A42;--shiki-dark:#61AFEF\">decode</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'utf-8'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'中文'</span></span></code></pre>\n</div><p>如果 <code v-pre>bytes</code> 中包含无法解码的字节，<code v-pre>decode()</code> 方法会报错:</p>\n<div class=\"language-sh\" data-highlighter=\"shiki\" data-ext=\"sh\" data-title=\"sh\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">>>> </span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">b</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">'\\xe4\\xb8\\xad\\xff'</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">.decode(</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">'utf-8'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">Traceback</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> (most </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">recent</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> call</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> last</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">):</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\">  ...</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">UnicodeDecodeError:</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> 'utf-8'</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> codec</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> can't decode byte 0xff in position 3: invalid start byte</span></span></code></pre>\n</div><p>如果 <code v-pre>bytes</code> 中只有一小部分无效的字节，可以传入 <code v-pre>errors='ignore'</code> 忽略错误的字节:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> b</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\">\\xe4\\xb8\\xad\\xff</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#383A42;--shiki-dark:#61AFEF\">decode</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'utf-8'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">errors</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'ignore'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'中'</span></span></code></pre>\n</div><p>要计算 <code v-pre>str</code> 包含多少个字符，可以用 <code v-pre>len()</code> 函数:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\"> len</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'ABC'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">3</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\"> len</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'中文'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">2</span></span></code></pre>\n</div><p><code v-pre>len()</code> 函数计算的是 <code v-pre>str</code> 的字符数，如果换成 <code v-pre>bytes</code>，<code v-pre>len()</code> 函数就计算字节数:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\"> len</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">b</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'ABC'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">3</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\"> len</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">b</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\">\\xe4\\xb8\\xad\\xe6\\x96\\x87</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">6</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\"> len</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'中文'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#383A42;--shiki-dark:#61AFEF\">encode</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'utf-8'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">))</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">6</span></span></code></pre>\n</div><p>可见，1 个中文字符经过 UTF-8 编码后通常会占用 3 个字节，而 1 个英文字符只占用 1 个字节。</p>\n<p>在操作字符串时，我们经常遇到 <code v-pre>str</code> 和 <code v-pre>bytes</code> 的互相转换。为了避免乱码问题，应当始终坚持使用 UTF-8 编码对 <code v-pre>str</code> 和 <code v-pre>bytes</code> 进行转换。</p>\n<p>由于 Python 源代码也是一个文本文件，所以，当您的源代码中包含中文的时候，在保存源代码时，就需要务必指定保存为 UTF-8 编码。当 Python 解释器读取源代码时，为了让它按 UTF-8 编码读取，我们通常在文件开头写上这两行:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># !/usr/bin/env python3</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># -*- coding: utf-8 -*-</span></span></code></pre>\n</div><p>第一行注释是为了告诉 Linux/macOS 系统，这是一个 Python 可执行程序，Windows 系统会忽略这个注释；</p>\n<p>第二行注释是为了告诉 Python 解释器，按照 UTF-8 编码读取源代码，否则，您在源代码中写的中文输出可能会有乱码。</p>\n<p>申明了 UTF-8 编码并不意味着您的 <code v-pre>.py</code> 文件就是 UTF-8 编码的，必须并且要确保文本编辑器正在使用 &quot;UTF-8 without BOM&quot; 编码。</p>\n<div class=\"hint-container info\">\n<p class=\"hint-container-title\">相关信息</p>\n<p>旧版 Windows 记事本的 UTF-8 是 UTF-8 with BOM。</p>\n<ul>\n<li>具体详情请见 <RouteLink to=\"/code/windows/notepad.html\">记事本的遗留问题</RouteLink></li>\n</ul>\n</div>\n<p>如果 <code v-pre>.py</code> 文件本身使用 UTF-8 编码，并且也申明了 <code v-pre># -*- coding: utf-8 -*-</code>，打开命令提示符测试就可以正常显示中文。</p>\n<h2 id=\"格式化\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#格式化\"><span>格式化</span></a></h2>\n<p>一个常见的问题是如何输出格式化的字符串。我们经常会输出类似 <code v-pre>'亲爱的xxx您好! 您xx月的话费是xx，余额是xx'</code> 之类的字符串，而 <code v-pre>xxx</code> 的内容都是根据变量变化的，所以，需要一种简便的格式化字符串的方式。</p>\n<p>在 Python 中，采用的格式化方式和 C 语言是一致的，用 <code v-pre>%</code> 实现，举例如下:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> 'Hello, </span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">%s</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\"> %</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> 'world'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'Hello, world'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> 'Hi, </span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">%s</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">, you have $</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">%d</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">.'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\"> %</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'Michael'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">1000000</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'Hi, Michael, you have $1000000.'</span></span></code></pre>\n</div><p>没错，<code v-pre>%</code> 运算符就是用来格式化字符串的。在字符串内部，<code v-pre>%s</code> 表示用字符串替换，<code v-pre>%d</code> 表示用整数替换，有几个 <code v-pre>%?</code> 占位符，后面就跟几个变量或者值，顺序要对应好。如果只有一个 <code v-pre>%?</code>，括号可以省略。</p>\n<div class=\"hint-container info\">\n<p class=\"hint-container-title\">常见的占位符有</p>\n<table>\n<thead>\n<tr>\n<th>占位符</th>\n<th>替换内容</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code v-pre>%d</code></td>\n<td>整数</td>\n</tr>\n<tr>\n<td><code v-pre>%f</code></td>\n<td>浮点数</td>\n</tr>\n<tr>\n<td><code v-pre>%s</code></td>\n<td>字符串</td>\n</tr>\n<tr>\n<td><code v-pre>%x</code></td>\n<td>十六进制整数</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>其中，格式化整数和浮点数还可以指定是否补 0 和整数与小数的位数:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># -*- coding: utf-8 -*-</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\">print</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">%2d</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">-</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">%02d</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\"> %</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">3</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">1</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">))</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\">print</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">%.2f</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\"> %</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\"> 3.1415926</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span></code></pre>\n</div><p>如果您不太确定应该用什么，<code v-pre>%s</code> 永远起作用，它会把任何数据类型转换为字符串:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> 'Age: </span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">%s</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">. Gender: </span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">%s</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\"> %</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">25</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">True</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'Age: 25. Gender: True'</span></span></code></pre>\n</div><p>有些时候，字符串里面的 <code v-pre>%</code> 是一个普通字符怎么办? 这个时候就需要转义，用 <code v-pre>%%</code> 来表示一个 <code v-pre>%</code>:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> 'growth rate: </span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">%d</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\"> %%</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\"> %</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\"> 7</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'growth rate: 7 %'</span></span></code></pre>\n</div><h3 id=\"format\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#format\"><span>format()</span></a></h3>\n<p>另一种格式化字符串的方法是使用字符串的 <code v-pre>format()</code> 方法，它会用传入的参数依次替换字符串内的占位符 <code v-pre>{0}</code>、<code v-pre>{1}</code>……，不过这种方式写起来比 <code v-pre>%</code> 要麻烦得多:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> 'Hello, </span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">{0}</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">, 成绩提升了 </span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">{1</span><span style=\"--shiki-light:#986801;--shiki-dark:#C678DD\">:.1f</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">}</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">%'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#383A42;--shiki-dark:#61AFEF\">format</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'小明'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">17.125</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'Hello, 小明, 成绩提升了 17.1%'</span></span></code></pre>\n</div><h3 id=\"小结\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#小结\"><span>小结</span></a></h3>\n<p>Python 3 的字符串使用 Unicode，直接支持多语言。</p>\n<p>当 <code v-pre>str</code> 和 <code v-pre>bytes</code> 互相转换时，需要指定编码。最常用的编码是 <code v-pre>UTF-8</code>。Python 当然也支持其他编码方式，比如把 Unicode 编码成 <code v-pre>GB2312</code>:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> '中文'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#383A42;--shiki-dark:#61AFEF\">encode</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'gb2312'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">b</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\">\\xd6\\xd0\\xce\\xc4</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span></span></code></pre>\n</div><p>但这种方式纯属自找麻烦，如果没有特殊业务要求，请牢记仅使用 UTF-8 编码。</p>\n<p>格式化字符串的时候，可以用 Python 的交互式环境测试，方便快捷。</p>\n</template>","contentStripped":"<p>在最新的 Python 3 版本中，字符串是以 Unicode 编码的，也就是说，Python 的字符串支持多语言，例如:</p>\n<div class=\"language-sh\" data-highlighter=\"shiki\" data-ext=\"sh\" data-title=\"sh\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">>>> </span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\">print</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">'包含中文的str'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">包含中文的str</span></span></code></pre>\n</div><p>对于单个字符的编码，Python 提供了 <code v-pre>ord()</code> 函数获取字符的整数表示，<code v-pre>chr()</code> 函数把编码转换为对应的字符:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\"> ord</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'A'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">65</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\"> ord</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'中'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">20013</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\"> chr</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">66</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'B'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\"> chr</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">25991</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'文'</span></span></code></pre>\n</div><p>如果知道字符的整数编码，还可以用十六进制这么写 <code v-pre>str</code>:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> '</span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\">\\u4e2d\\u6587</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'中文'</span></span></code></pre>\n</div><p>两种写法完全是等价的。</p>\n<p>由于 Python 的字符串类型是 <code v-pre>str</code>，在内存中以 Unicode 表示，一个字符对应若干个字节。如果要在网络上传输，或者保存到磁盘上，就需要把 <code v-pre>str</code> 变为以字节为单位的 <code v-pre>bytes</code>。</p>\n<p>Python 对 <code v-pre>bytes</code> 类型的数据用带 <code v-pre>b</code> 前缀的单引号或双引号表示:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">x </span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> b</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'ABC'</span></span></code></pre>\n</div><p>要注意区分 <code v-pre>'ABC'</code> 和 <code v-pre>b'ABC'</code>，前者是 <code v-pre>str</code>，后者虽然内容显示得和前者一样，但 <code v-pre>bytes</code> 的每个字符都只占用一个字节。</p>\n<p>以 Unicode 表示的 <code v-pre>str</code> 通过 <code v-pre>encode()</code> 方法可以编码为指定的 <code v-pre>bytes</code>，例如:</p>\n<div class=\"language-sh\" data-highlighter=\"shiki\" data-ext=\"sh\" data-title=\"sh\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">>>> </span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">'ABC'</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">.encode(</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">'ascii'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">b</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">'ABC'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">>>> </span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">'中文'</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">.encode(</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">'utf-8'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">b</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">'\\xe4\\xb8\\xad\\xe6\\x96\\x87'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">>>> </span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">'中文'</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">.encode(</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">'ascii'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">Traceback</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> (most </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">recent</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> call</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> last</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">):</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">  File</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> \"&#x3C;stdin>\",</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> line</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> 1,</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> in</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> &#x3C;</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">modul</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">e></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">UnicodeEncodeError:</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> 'ascii'</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> codec</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> can't encode characters in position 0-1: ordinal not in range(128)</span></span></code></pre>\n</div><p>纯英文的 <code v-pre>str</code> 可以用 ASCII 编码为 <code v-pre>bytes</code>，内容是一样的，含有中文的 <code v-pre>str</code> 可以用 UTF-8 编码为 <code v-pre>bytes</code>。含有中文的 <code v-pre>str</code> 无法用 ASCII 编码，因为中文编码的范围超过了 ASCII 编码的范围，Python 会报错。</p>\n<p>在 <code v-pre>bytes</code> 中，无法显示为 ASCII 字符的字节，用 <code v-pre>\\x##</code> 显示。</p>\n<p>反过来，如果我们从网络或磁盘上读取了字节流，那么读到的数据就是 <code v-pre>bytes</code>。要把 <code v-pre>bytes</code> 变为 <code v-pre>str</code>，就需要用 <code v-pre>decode()</code> 方法:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> b</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'ABC'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#383A42;--shiki-dark:#61AFEF\">decode</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'ascii'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'ABC'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> b</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\">\\xe4\\xb8\\xad\\xe6\\x96\\x87</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#383A42;--shiki-dark:#61AFEF\">decode</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'utf-8'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'中文'</span></span></code></pre>\n</div><p>如果 <code v-pre>bytes</code> 中包含无法解码的字节，<code v-pre>decode()</code> 方法会报错:</p>\n<div class=\"language-sh\" data-highlighter=\"shiki\" data-ext=\"sh\" data-title=\"sh\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">>>> </span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">b</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">'\\xe4\\xb8\\xad\\xff'</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">.decode(</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">'utf-8'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">Traceback</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> (most </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">recent</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> call</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> last</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">):</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\">  ...</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">UnicodeDecodeError:</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> 'utf-8'</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> codec</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> can't decode byte 0xff in position 3: invalid start byte</span></span></code></pre>\n</div><p>如果 <code v-pre>bytes</code> 中只有一小部分无效的字节，可以传入 <code v-pre>errors='ignore'</code> 忽略错误的字节:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> b</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\">\\xe4\\xb8\\xad\\xff</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#383A42;--shiki-dark:#61AFEF\">decode</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'utf-8'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">errors</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'ignore'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'中'</span></span></code></pre>\n</div><p>要计算 <code v-pre>str</code> 包含多少个字符，可以用 <code v-pre>len()</code> 函数:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\"> len</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'ABC'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">3</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\"> len</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'中文'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">2</span></span></code></pre>\n</div><p><code v-pre>len()</code> 函数计算的是 <code v-pre>str</code> 的字符数，如果换成 <code v-pre>bytes</code>，<code v-pre>len()</code> 函数就计算字节数:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\"> len</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">b</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'ABC'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">3</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\"> len</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">b</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\">\\xe4\\xb8\\xad\\xe6\\x96\\x87</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">6</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\"> len</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'中文'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#383A42;--shiki-dark:#61AFEF\">encode</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'utf-8'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">))</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">6</span></span></code></pre>\n</div><p>可见，1 个中文字符经过 UTF-8 编码后通常会占用 3 个字节，而 1 个英文字符只占用 1 个字节。</p>\n<p>在操作字符串时，我们经常遇到 <code v-pre>str</code> 和 <code v-pre>bytes</code> 的互相转换。为了避免乱码问题，应当始终坚持使用 UTF-8 编码对 <code v-pre>str</code> 和 <code v-pre>bytes</code> 进行转换。</p>\n<p>由于 Python 源代码也是一个文本文件，所以，当您的源代码中包含中文的时候，在保存源代码时，就需要务必指定保存为 UTF-8 编码。当 Python 解释器读取源代码时，为了让它按 UTF-8 编码读取，我们通常在文件开头写上这两行:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># !/usr/bin/env python3</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># -*- coding: utf-8 -*-</span></span></code></pre>\n</div><p>第一行注释是为了告诉 Linux/macOS 系统，这是一个 Python 可执行程序，Windows 系统会忽略这个注释；</p>\n<p>第二行注释是为了告诉 Python 解释器，按照 UTF-8 编码读取源代码，否则，您在源代码中写的中文输出可能会有乱码。</p>\n<p>申明了 UTF-8 编码并不意味着您的 <code v-pre>.py</code> 文件就是 UTF-8 编码的，必须并且要确保文本编辑器正在使用 &quot;UTF-8 without BOM&quot; 编码。</p>\n<div class=\"hint-container info\">\n<p class=\"hint-container-title\">相关信息</p>\n<p>旧版 Windows 记事本的 UTF-8 是 UTF-8 with BOM。</p>\n<ul>\n<li>具体详情请见 <RouteLink to=\"/code/windows/notepad.html\">记事本的遗留问题</RouteLink></li>\n</ul>\n</div>\n<p>如果 <code v-pre>.py</code> 文件本身使用 UTF-8 编码，并且也申明了 <code v-pre># -*- coding: utf-8 -*-</code>，打开命令提示符测试就可以正常显示中文。</p>\n<h2 id=\"格式化\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#格式化\"><span>格式化</span></a></h2>\n<p>一个常见的问题是如何输出格式化的字符串。我们经常会输出类似 <code v-pre>'亲爱的xxx您好! 您xx月的话费是xx，余额是xx'</code> 之类的字符串，而 <code v-pre>xxx</code> 的内容都是根据变量变化的，所以，需要一种简便的格式化字符串的方式。</p>\n<p>在 Python 中，采用的格式化方式和 C 语言是一致的，用 <code v-pre>%</code> 实现，举例如下:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> 'Hello, </span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">%s</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\"> %</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> 'world'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'Hello, world'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> 'Hi, </span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">%s</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">, you have $</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">%d</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">.'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\"> %</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'Michael'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">1000000</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'Hi, Michael, you have $1000000.'</span></span></code></pre>\n</div><p>没错，<code v-pre>%</code> 运算符就是用来格式化字符串的。在字符串内部，<code v-pre>%s</code> 表示用字符串替换，<code v-pre>%d</code> 表示用整数替换，有几个 <code v-pre>%?</code> 占位符，后面就跟几个变量或者值，顺序要对应好。如果只有一个 <code v-pre>%?</code>，括号可以省略。</p>\n<div class=\"hint-container info\">\n<p class=\"hint-container-title\">常见的占位符有</p>\n<table>\n<thead>\n<tr>\n<th>占位符</th>\n<th>替换内容</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code v-pre>%d</code></td>\n<td>整数</td>\n</tr>\n<tr>\n<td><code v-pre>%f</code></td>\n<td>浮点数</td>\n</tr>\n<tr>\n<td><code v-pre>%s</code></td>\n<td>字符串</td>\n</tr>\n<tr>\n<td><code v-pre>%x</code></td>\n<td>十六进制整数</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>其中，格式化整数和浮点数还可以指定是否补 0 和整数与小数的位数:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\"># -*- coding: utf-8 -*-</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\">print</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">%2d</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">-</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">%02d</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\"> %</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">3</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">1</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">))</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\">print</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">%.2f</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\"> %</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\"> 3.1415926</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span></code></pre>\n</div><p>如果您不太确定应该用什么，<code v-pre>%s</code> 永远起作用，它会把任何数据类型转换为字符串:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> 'Age: </span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">%s</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">. Gender: </span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">%s</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\"> %</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">25</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">True</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'Age: 25. Gender: True'</span></span></code></pre>\n</div><p>有些时候，字符串里面的 <code v-pre>%</code> 是一个普通字符怎么办? 这个时候就需要转义，用 <code v-pre>%%</code> 来表示一个 <code v-pre>%</code>:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> 'growth rate: </span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">%d</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\"> %%</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\"> %</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\"> 7</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'growth rate: 7 %'</span></span></code></pre>\n</div><h3 id=\"format\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#format\"><span>format()</span></a></h3>\n<p>另一种格式化字符串的方法是使用字符串的 <code v-pre>format()</code> 方法，它会用传入的参数依次替换字符串内的占位符 <code v-pre>{0}</code>、<code v-pre>{1}</code>……，不过这种方式写起来比 <code v-pre>%</code> 要麻烦得多:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> 'Hello, </span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">{0}</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">, 成绩提升了 </span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">{1</span><span style=\"--shiki-light:#986801;--shiki-dark:#C678DD\">:.1f</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">}</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">%'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#383A42;--shiki-dark:#61AFEF\">format</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'小明'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">17.125</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'Hello, 小明, 成绩提升了 17.1%'</span></span></code></pre>\n</div><h3 id=\"小结\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#小结\"><span>小结</span></a></h3>\n<p>Python 3 的字符串使用 Unicode，直接支持多语言。</p>\n<p>当 <code v-pre>str</code> 和 <code v-pre>bytes</code> 互相转换时，需要指定编码。最常用的编码是 <code v-pre>UTF-8</code>。Python 当然也支持其他编码方式，比如把 Unicode 编码成 <code v-pre>GB2312</code>:</p>\n<div class=\"language-py\" data-highlighter=\"shiki\" data-ext=\"py\" data-title=\"py\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre v-pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">>>></span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> '中文'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#383A42;--shiki-dark:#61AFEF\">encode</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'gb2312'</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">b</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span><span style=\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\">\\xd6\\xd0\\xce\\xc4</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">'</span></span></code></pre>\n</div><p>但这种方式纯属自找麻烦，如果没有特殊业务要求，请牢记仅使用 UTF-8 编码。</p>\n<p>格式化字符串的时候，可以用 Python 的交互式环境测试，方便快捷。</p>\n","tagOpen":"<template>","tagClose":"</template>"},"script":null,"scriptSetup":null,"scripts":[],"styles":[],"customBlocks":[]},"content":"\n在最新的 Python 3 版本中，字符串是以 Unicode 编码的，也就是说，Python 的字符串支持多语言，例如:\n\n```sh\n>>> print('包含中文的str')\n包含中文的str\n```\n\n对于单个字符的编码，Python 提供了 `ord()` 函数获取字符的整数表示，`chr()` 函数把编码转换为对应的字符:\n\n```py\n>>> ord('A')\n65\n>>> ord('中')\n20013\n>>> chr(66)\n'B'\n>>> chr(25991)\n'文'\n```\n\n如果知道字符的整数编码，还可以用十六进制这么写 `str`:\n\n```py\n>>> '\\u4e2d\\u6587'\n'中文'\n```\n\n两种写法完全是等价的。\n\n由于 Python 的字符串类型是 `str`，在内存中以 Unicode 表示，一个字符对应若干个字节。如果要在网络上传输，或者保存到磁盘上，就需要把 `str` 变为以字节为单位的 `bytes`。\n\nPython 对 `bytes` 类型的数据用带 `b` 前缀的单引号或双引号表示:\n\n```py\nx = b'ABC'\n```\n\n要注意区分 `'ABC'` 和 `b'ABC'`，前者是 `str`，后者虽然内容显示得和前者一样，但 `bytes` 的每个字符都只占用一个字节。\n\n以 Unicode 表示的 `str` 通过 `encode()` 方法可以编码为指定的 `bytes`，例如:\n\n```sh\n>>> 'ABC'.encode('ascii')\nb'ABC'\n>>> '中文'.encode('utf-8')\nb'\\xe4\\xb8\\xad\\xe6\\x96\\x87'\n>>> '中文'.encode('ascii')\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nUnicodeEncodeError: 'ascii' codec can't encode characters in position 0-1: ordinal not in range(128)\n```\n\n纯英文的 `str` 可以用 ASCII 编码为 `bytes`，内容是一样的，含有中文的 `str` 可以用 UTF-8 编码为 `bytes`。含有中文的 `str` 无法用 ASCII 编码，因为中文编码的范围超过了 ASCII 编码的范围，Python 会报错。\n\n在 `bytes` 中，无法显示为 ASCII 字符的字节，用 `\\x##` 显示。\n\n反过来，如果我们从网络或磁盘上读取了字节流，那么读到的数据就是 `bytes`。要把 `bytes` 变为 `str`，就需要用 `decode()` 方法:\n\n```py\n>>> b'ABC'.decode('ascii')\n'ABC'\n>>> b'\\xe4\\xb8\\xad\\xe6\\x96\\x87'.decode('utf-8')\n'中文'\n```\n\n如果 `bytes` 中包含无法解码的字节，`decode()` 方法会报错:\n\n```sh\n>>> b'\\xe4\\xb8\\xad\\xff'.decode('utf-8')\nTraceback (most recent call last):\n  ...\nUnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte\n```\n\n如果 `bytes` 中只有一小部分无效的字节，可以传入 `errors='ignore'` 忽略错误的字节:\n\n```py\n>>> b'\\xe4\\xb8\\xad\\xff'.decode('utf-8', errors='ignore')\n'中'\n```\n\n要计算 `str` 包含多少个字符，可以用 `len()` 函数:\n\n```py\n>>> len('ABC')\n3\n>>> len('中文')\n2\n```\n\n`len()` 函数计算的是 `str` 的字符数，如果换成 `bytes`，`len()` 函数就计算字节数:\n\n```py\n>>> len(b'ABC')\n3\n>>> len(b'\\xe4\\xb8\\xad\\xe6\\x96\\x87')\n6\n>>> len('中文'.encode('utf-8'))\n6\n```\n\n可见，1 个中文字符经过 UTF-8 编码后通常会占用 3 个字节，而 1 个英文字符只占用 1 个字节。\n\n在操作字符串时，我们经常遇到 `str` 和 `bytes` 的互相转换。为了避免乱码问题，应当始终坚持使用 UTF-8 编码对 `str` 和 `bytes` 进行转换。\n\n由于 Python 源代码也是一个文本文件，所以，当您的源代码中包含中文的时候，在保存源代码时，就需要务必指定保存为 UTF-8 编码。当 Python 解释器读取源代码时，为了让它按 UTF-8 编码读取，我们通常在文件开头写上这两行:\n\n```py\n# !/usr/bin/env python3\n\n# -*- coding: utf-8 -*-\n```\n\n第一行注释是为了告诉 Linux/macOS 系统，这是一个 Python 可执行程序，Windows 系统会忽略这个注释；\n\n第二行注释是为了告诉 Python 解释器，按照 UTF-8 编码读取源代码，否则，您在源代码中写的中文输出可能会有乱码。\n\n申明了 UTF-8 编码并不意味着您的 `.py` 文件就是 UTF-8 编码的，必须并且要确保文本编辑器正在使用 \"UTF-8 without BOM\" 编码。\n\n::: info\n\n旧版 Windows 记事本的 UTF-8 是 UTF-8 with BOM。\n\n- 具体详情请见 [记事本的遗留问题](../../../windows/notepad.md)\n\n:::\n\n如果 `.py` 文件本身使用 UTF-8 编码，并且也申明了 `# -*- coding: utf-8 -*-`，打开命令提示符测试就可以正常显示中文。\n\n## 格式化\n\n一个常见的问题是如何输出格式化的字符串。我们经常会输出类似 `'亲爱的xxx您好! 您xx月的话费是xx，余额是xx'` 之类的字符串，而 `xxx` 的内容都是根据变量变化的，所以，需要一种简便的格式化字符串的方式。\n\n在 Python 中，采用的格式化方式和 C 语言是一致的，用 `%` 实现，举例如下:\n\n```py\n>>> 'Hello, %s' % 'world'\n'Hello, world'\n>>> 'Hi, %s, you have $%d.' % ('Michael', 1000000)\n'Hi, Michael, you have $1000000.'\n```\n\n没错，`%` 运算符就是用来格式化字符串的。在字符串内部，`%s` 表示用字符串替换，`%d` 表示用整数替换，有几个 `%?` 占位符，后面就跟几个变量或者值，顺序要对应好。如果只有一个 `%?`，括号可以省略。\n\n::: info 常见的占位符有\n\n| 占位符 | 替换内容     |\n| ------ | ------------ |\n| `%d`   | 整数         |\n| `%f`   | 浮点数       |\n| `%s`   | 字符串       |\n| `%x`   | 十六进制整数 |\n\n:::\n\n其中，格式化整数和浮点数还可以指定是否补 0 和整数与小数的位数:\n\n```py\n# -*- coding: utf-8 -*-\nprint('%2d-%02d' % (3, 1))\nprint('%.2f' % 3.1415926)\n```\n\n如果您不太确定应该用什么，`%s` 永远起作用，它会把任何数据类型转换为字符串:\n\n```py\n>>> 'Age: %s. Gender: %s' % (25, True)\n'Age: 25. Gender: True'\n```\n\n有些时候，字符串里面的 `%` 是一个普通字符怎么办? 这个时候就需要转义，用 `%%` 来表示一个 `%`:\n\n```py\n>>> 'growth rate: %d %%' % 7\n'growth rate: 7 %'\n```\n\n### format()\n\n另一种格式化字符串的方法是使用字符串的 `format()` 方法，它会用传入的参数依次替换字符串内的占位符 `{0}`、`{1}`……，不过这种方式写起来比 `%` 要麻烦得多:\n\n```py\n>>> 'Hello, {0}, 成绩提升了 {1:.1f}%'.format('小明', 17.125)\n'Hello, 小明, 成绩提升了 17.1%'\n```\n\n### 小结\n\nPython 3 的字符串使用 Unicode，直接支持多语言。\n\n当 `str` 和 `bytes` 互相转换时，需要指定编码。最常用的编码是 `UTF-8`。Python 当然也支持其他编码方式，比如把 Unicode 编码成 `GB2312`:\n\n```py\n>>> '中文'.encode('gb2312')\nb'\\xd6\\xd0\\xce\\xc4'\n```\n\n但这种方式纯属自找麻烦，如果没有特殊业务要求，请牢记仅使用 UTF-8 编码。\n\n格式化字符串的时候，可以用 Python 的交互式环境测试，方便快捷。\n","excerpt":"","title":"","headers":[{"level":2,"title":"格式化","slug":"格式化","link":"#格式化","children":[{"level":3,"title":"format()","slug":"format","link":"#format","children":[]},{"level":3,"title":"小结","slug":"小结","link":"#小结","children":[]}]}],"links":[{"raw":"../../../windows/notepad.md","relative":"code/windows/notepad.md","absolute":"/code/windows/notepad.md"}]}}
